<div class="profile view-profile">
    <div class="row">
        <div class="col-sm-6">
            <div class="pic">
            {{ if .Profile.Pic }}
                <a class="image-link"
                   href="/img/profilepics/{{ .Profile.GetAddressString }}-640x640.{{ .Profile.Pic.GetExtension }}?id={{ .Profile.Pic.Id }}"
                   target="_blank">
                    <img class="profile-pic"
                         src="/img/profilepics/{{ .Profile.GetAddressString }}-128x128.{{ .Profile.Pic.GetExtension }}?id={{ .Profile.Pic.Id }}"/>
                </a>
            {{ else }}
                <span class="profile-identicon-{{ .Profile.GetAddressString }}">
                    <img class="identicon"/>
                </span>
            {{ end }}
            </div>
            <div class="title">
                <h3>
                {{ .Profile.Name }}
                {{ if .Profile.Reputation }}
                {{ template "snippets/reputation.html" .Profile.Reputation }}
                {{ if .Profile.IsSelf }}
                    <span style="font-size:12px;">This is you!</span>
                {{ end }}
                {{ end }}
                </h3>
                <p class="joined">Joined <b>{{ .Profile.GetJoined }}</b></p>
                <p>
                {{ .Profile.GetText }}
                </p>
            {{ $isLoggedIn := .IsLoggedIn }}
            {{ if $isLoggedIn }}
                {{ if not .Profile.IsSelf }}
                    <span>
                        <a class="btn btn-sm btn-primary"
                        href="memo/private-message/{{ .Profile.GetAddressString }}">{{ T "message" 1 }}</a>
                    </span>
                {{ end }}
            {{ end }}
            {{ if .Profile.CanFollow }}
                <span>
                        <a class="btn btn-sm btn-primary"
                           href="memo/follow/{{ .Profile.GetAddressString }}">{{ T "follow" 1 }}</a>
                    </span>
            {{ else if .Profile.CanUnfollow }}
                <span>
                        <a class="btn btn-sm btn-default"
                           href="memo/unfollow/{{ .Profile.GetAddressString }}">{{ T "unfollow" }}</a>
                    </span>
            {{ end }}
                <div class="dropdown">
                    <a class="nav-link dropdown-toggle btn btn-sm btn-default" data-toggle="dropdown" href="#">
                        &nbsp;<span class="glyphicon glyphicon-th"></span>&nbsp;
                    </a>
                    <ul class="dropdown-menu dropdown-menu-right">
                        <li class="dropdown-header">Block Explorer</li>
                        <li><a target="_blank"
                               href="https://explorer.bitcoin.com/bch/address/{{ .Profile.GetAddressString }}">
                        {{ T "Bitcoin.com" }}
                        </a></li>
                        <li><a target="_blank"
                               href="https://blockchair.com/bitcoin-cash/address/{{ .Profile.GetAddressString }}">
                        {{ T "Blockchair" }}
                        </a></li>
                        <li><a target="_blank"
                               href="https://bch.btc.com/{{ .Profile.GetAddressString }}">
                            BTC.com
                        </a></li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="col-sm-6">
            <table class="table left profile table-striped table-condensed">
                <tbody>
                <tr>
                    <td colspan="2">
                        <a href="{{ .Profile.GetCashAddressString }}">{{ .Profile.GetCashAddressOnlyString }}</a>
                        <span class="click-for-qr">
                            <a href="#" id="qr-code-link"><span class="glyphicon glyphicon-triangle-bottom"></span></a>
                        </span>
                        <div id="qr-code">
                            <img src="data:image/png;base64,{{ .Profile.Qr }}"/>
                            <br/>
                            <span class="click-for-qr">Legacy Address</span>
                            <br/>
                        {{ .Profile.GetAddressString }}
                        </div>
                    </td>
                </tr>
                {{ if .Profile.HasBalance }}
                <tr>
                    <td colspan="2">
                    {{ formatBigInt .Profile.Balance }} satoshis
                        ({{ formatBigFloat .Profile.BalanceBCH }} BCH)
                    </td>
                </tr>
                {{ end }}
                {{ if or (not .Profile.IsSelf) (not .Profile.HasBalance) }}
                <tr>
                    <th>{{ T "Actions" }}</th>
                    <td>
                    {{ formatInt .Profile.NumPosts }}
                    </td>
                </tr>
                <tr>
                    <th>{{ T "following" }}</th>
                    <td>
                        <a href="profile/following/{{ .Profile.GetAddressString }}">
                        {{ formatInt .Profile.FollowingCount }}
                        </a>
                    </td>
                </tr>
                <tr>
                    <th>{{ T "followers" }}</th>
                    <td>
                        <a href="profile/followers/{{ .Profile.GetAddressString }}">
                        {{ formatInt .Profile.FollowerCount }}
                        </a>
                    </td>
                </tr>
                <tr>
                    <th>{{ T "topics_following" | UcFirst }}</th>
                    <td>
                        <a href="profile/topics-following/{{ .Profile.GetAddressString }}">
                        {{ formatInt .Profile.TopicsFollowingCount }}
                        </a>
                    </td>
                </tr>
                {{ end }}
                </tbody>
            </table>
        </div>
    </div>
</div>

<script type="text/javascript">
    (function () {
        $("#qr-code-link").click(function (e) {
            e.preventDefault();
            $("#qr-code").toggle();
        });
        var foreground = {{ if eq .UserSettings.Theme "dark" }}[224, 224, 224, 255]{{ else }}[180, 180, 180, 255]{{ end }};
        var background = [0, 0, 0, 0];
        var data = new Identicon('{{ .Profile.GetAddressString }}', {
            foreground: foreground,
            background: background,
            size: 128,
            margin: 0
        }).toString();
        $(".profile-identicon-{{ .Profile.GetAddressString }}").html('<img class="identicon" src="data:image/png;base64,' + data + '">');
    })();
</script>
